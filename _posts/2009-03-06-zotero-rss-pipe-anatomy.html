---
layout: wordpress-import
status: publish
published: true
title: Anatomy of the Zotero Library to RSS Feed Pipe
author: Peter Murray
author_login: lyrdor
author_email: jester@dltj.org
author_url: http://dltj.org/about
wordpress_id: 788
wordpress_url: http://dltj.org/?p=788
date: '2009-03-06 07:30:53 -0500'
date_gmt: '2009-03-06 12:30:53 -0500'
categories:
- Raw Technology
tags:
- howto
- Zotero
- rss
- Yahoo pipes
comments:
- id: 36367
  author: Zotero Forums - RSS feed for my Library
  author_email: ''
  author_url: http://forums.zotero.org/discussion/7370/?Focus=32796
  date: '2009-06-07 03:37:03 -0400'
  date_gmt: '2009-06-07 07:37:03 -0400'
  content: "<!--%kramer-ref-pre%-->[...] CommentTime9 minutes ago   &nbsp;  They're
    planned:http://forums.zotero.org/discussion/5793/twitterrss-like-option/and you
    can DIY if you don't want to wait:http://dltj.org/article/zotero-rss-pipe-anatomy/
    [...]<!--%kramer-ref-post%-->"
- id: 162140
  author: Julien Sicot
  author_email: ''
  author_url: http://twitter.com/jsicot/status/1857547192
  date: '2009-05-20 09:08:01 -0400'
  date_gmt: '2009-05-20 13:08:01 -0400'
  content: |-
    <span class="topsy_trackback_comment"><span class="topsy_twitter_username"><span class="topsy_trackback_content">@bbober d'autres infos ici :  http://bit.ly/b3uiQ
     #zoteroENrss</span></span>
- id: 162141
  author: ALA_TechSource
  author_email: ''
  author_url: http://twitter.com/ala_techsource/status/1288586098
  date: '2009-03-06 15:16:38 -0500'
  date_gmt: '2009-03-06 20:16:38 -0500'
  content: "<span class=\"topsy_trackback_comment\"><span class=\"topsy_twitter_username\"><span
    class=\"topsy_trackback_content\">Anatomy of the Zotero Library to RSS Feed Pipe
    at Disruptive Library Technology Jester:\r\nhttp://tinyurl.com/c8zdsj</span></span>"
- id: 162142
  author: infopeep
  author_email: ''
  author_url: http://twitter.com/infopeep/status/1288067997
  date: '2009-03-06 12:51:17 -0500'
  date_gmt: '2009-03-06 17:51:17 -0500'
  content: "<span class=\"topsy_trackback_comment\"><span class=\"topsy_twitter_username\"><span
    class=\"topsy_trackback_content\">Murray, Peter: Anatomy of the Zotero Library
    to RSS Feed Pipe: \nLast week I posted about a Yahoo Pipes construct.. http://snipurl.com/d8c3n</span></span>"
- id: 162143
  author: Peter Murray
  author_email: ''
  author_url: http://twitter.com/datag/status/1288014071
  date: '2009-03-06 12:31:03 -0500'
  date_gmt: '2009-03-06 17:31:03 -0500'
  content: '<span class="topsy_trackback_comment"><span class="topsy_twitter_username"><span
    class="topsy_trackback_content">New blog post: Anatomy of the Zotero Library to
    RSS Feed Pipe http://tinyurl.com/c8zdsj</span></span>'
---
<div style="border: 2px solid red; text-color: black; background: #EEE; padding:1em;">Note!  A new feature on the Zotero website does away with the need to use this Yahoo! Pipe.  RSS feeds are now generated by the Zotero website itself.  <a href="http://www.zotero.org/blog/follow-libraries-and-collections-with-feeds/" title="Zotero Blog  &amp;raquo; Blog Archive   &amp;raquo; Follow Libraries and Collections with Feeds">Read more about it</a> on the Zotero blog.</div>
<p>Last week I posted about a <a href="http://dltj.org/article/zotero-library-rss/">Yahoo Pipes construct that turns a Zotero website library into an RSS feed</a>.  As Dan Cohen noted in a <a href="http://twitter.com/dancohen/statuses/1265440178" title="Twitter from Dan Cohen to Peter Murray">twitter response</a> to the posting, the Zotero team is planning to add an RSS capability in a future release of the website, so this pipe will ultimately be usurped by that capability, but in the meantime it is <span class="removed_link" title="http://pipes.yahoo.com/peteratohiolink/zoterolibraryrss">a handy tool</span>.  It was my first full-scale foray into creating a Yahoo Pipes construct from scratch, so I thought it would be useful to document how it works (in case I need to do something similar again).  You might find this useful, too; especially the part about how to put a pubDate element into the RSS feed.</p>
<p>[caption id="attachment_788" align="alignnone" width="927" caption="Graphic representation of the Yahoo! Pipes construct to turn a Zotero library web page into an RSS feed."]<br />
<table width="925" cellpadding="0" cellspacing="0">
<tr>
<td colspan="2"><img src="http://dltj.org/wp-content/uploads/2009/02/pipes-top.png" alt="" title="" width="923" height="422" class="alignnone size-full wp-image-788" /></td>
</tr>
<tr>
<td width="426" valign="top"><img src="http://dltj.org/wp-content/uploads/2009/02/pipes-left.png" alt="" title="" width="426" height="681" class="alignnone size-full wp-image-789" /></td>
<td valign="top" style="padding:1em 0 0 1em; text-align:left">
A couple of things to note:</p>
<ul type="disc">
<li>The basic structure is to iterate over a list of items.  The modules on the right side (above) work to construct a URL to the Zotero Library page while the modules on the left actually get that page, find the list of items (by defining where the list is located in the HTML structure), and massage them into an RSS feed.  In the case of this example, the Pipe is iterating over a list of <code>MARKDOWN_HASHc5a022f415caf33831dd2bd16bb78acdMARKDOWN_HASH</code> elements in the table that displays the library items.</li>
<li>Strings with elements separated by periods are XPATH-like constructs.  For instance, the "Path to Item List" in the upper right module is <code>MARKDOWN_HASHde59e576fea258ba884e4a675dc71b1aMARKDOWN_HASH</code>.  The corresponding XPATH is <code>MARKDOWN_HASHa35f832ec98dad177813cb1ff5a014e6MARKDOWN_HASH</code>.  Note a few things: the leading element (<code>MARKDOWN_HASHf8157d1ab1b65c3518e92989802d8ab2MARKDOWN_HASH</code>) is omitted, slashes are replaced by periods, and ordinal numbers are separated from their base elements with periods and are subtracted by 1.  Later on there are examples where attribute names ("<code>MARKDOWN_HASHbd25526c088b87e9cb6d3660bd3b1c5fMARKDOWN_HASH</code>") and references to text nodes ("<code>MARKDOWN_HASH17c174cbe0e5faa4f2895a15e0c70c5dMARKDOWN_HASH</code>") are also included in these path strings.</li>
</ul>
</td>
</tr>
</table>
<p>[/caption]</p>
<p>The process starts with the two <span class="removed_link" title="http://pipes.yahoo.com/pipes/docs?doc=user_inputs#PrivateText">Private Text Input</span> modules at the top right &mdash; one each for the Zotero Username and the Zotero User Number.  The defaults are set to my values, and they are marked private &mdash; meaning that if someone clones this pipe, these values are not carried along.</p>
<p>Directly below is a <span class="removed_link" title="http://pipes.yahoo.com/pipes/docs?doc=url#URLBuilder">URL Builder</span> module.  The base URL is <code>http://www.zotero.org</code>, and there are three path elements:  the first is a connection from the <i>Zotero Username</i> Private Text Input, the second is a connection from the <i>Zotero User Number</i> Private Text Input, and the third is the literal "<code>items</code>".  This builds a URL that looks like <code>http://www.zotero.org/dltj/683/items</code> and that corresponds to the <a href="http://www.zotero.org/dltj/683/items" title="Zotero: Library">Zotero user's library items page</a>.</p>
<p>Starting at the upper left of the diagram, the output of the URL Builder is connected to the URL field of a <span class="removed_link" title="http://pipes.yahoo.com/pipes/docs?doc=sources#FetchData">Fetch Data</span> module.  The "Path to Item List" parameter is set to <code>body.div.1.div.div.1.table.tbody.tr</code> and that is a pointer to the portion of the XHTML document that contains the library items.  Because the Zotero website is outputting XML (as XHTML), we can use the Fetch Data module and parse the page as if it was an XML document.  The Path to Item List is an XPATH-like structure that points into the document structure (see note above).  The result of this module is a list of items &mdash; the table rows in this case &mdash; that are processed by the remaining modules.</p>
<p>The next module down is a <span class="removed_link" title="http://pipes.yahoo.com/pipes/docs?doc=operators#Rename">Rename</span> module, where the value of the XPATH-like path <code>item.td.0.a.content</code> is copied to the item <code>title</code> element.  The XPATH, from the root of the "Path to Item List" in the module above, is <code>td/a</code>; note here the added <code>item</code> at the front and the <code>content</code> at the end. Specifying the zeroth <code>td</code> element isn't needed, but it brings symmetry with subsequent modules.  <code>content</code> corresponds to the text node under the <code>a</code> element when viewing this as an XML document.</p>
<p>What follows is a series of <span class="removed_link" title="http://pipes.yahoo.com/pipes/docs?doc=operators#Loop">Loop</span> modules that act on different parts of the items in the list.  The first builds the <code>link</code> element of the item using the <span class="removed_link" title="http://pipes.yahoo.com/pipes/docs?doc=string#StringBuilder">String Builder</span> module.   The <code>href</code> in the XML is a relative path, so the String Builder adds the literal "<code>http://www.zotero.org</code>" to the value found in <code>item.td.0.a.href</code> (the <code>href</code> attribute of the anchor element of the first <code>td</code> element).  The resulting string is assigned to the <code>link</code> element of each item in the list.</p>
<p>The second Loop module encapsulates a <span class="removed_link" title="http://pipes.yahoo.com/pipes/docs?doc=date#DateBuilder">Date Builder</span> module, and this is the inspiration for writing this post.  It took a very long time to figure out how to get the <code>pubDate</code> element into each item of the resulting RSS feed.  As it turns out, one cannot simple assign the <code>pubDate</code> element like we did the <code>title</code> element above.  Instead, one sets the timestamp to the <code>y:published</code> element and Yahoo Pipes takes it from there.  And it isn't enough to assign a text string to that element; it has to be a Date type, constructed using the Date Builder module.  The Date Builder module is very flexible in what it accepts, and it creates a canonical timestamp form that can be used by other modules.  In this case, the Date Builder module takes as a source input the string value found at <code>item.td.2.a.content</code>.  Believe me -- it took a long time to figure this out, and it was only done by piecing together various suggestions and examples; there doesn't seem to be any clear documentation about this.</p>
<p>The third and fourth Loop modules go together.  The third takes the value found in <code>item.td.0.a.span.class</code> and applies a <span class="removed_link" title="http://pipes.yahoo.com/pipes/docs?doc=operators#Regex">String Regex</span> module to it.  The value of that class attribute contains the type of item in the Zotero library, and it takes the form of "<code>img-book</code>" or "<code>img-journalArticle</code>" or "<code>img-conferencePaper</code>".  There are two regular expressions defined:  the first removes the "<code>img-</code>" prefix from each value and the second replaces all instances of an upper case letter with a space plus the lower case version of the letter.  The latter rule turns "<code>journalArticle</code>" into "<code>journal article</code>" (note that there is a space in this field prior to the <code>\L</code> part).  The result is assigned to the <code>item.itemType</code> element.  This is used in the final Loop module to build a <code>item.description</code> element to create the string:  <code>
<p>This journal article  was saved to my Zotero library.</p>
<p></code>.</p>
<p>That's all there is to it.  Yahoo Pipes applies all of these modules to each of the items in the list retrieved from the Zotero library page and generates the corresponding RSS feed.</p>
