---
layout: wordpress-import
status: publish
published: true
title: Embedded Web Video in a Standards-Compliant, Accessible, and Successful Way
author: Peter Murray
author_login: lyrdor
author_email: jester@dltj.org
author_url: http://dltj.org/about
wordpress_id: 128
wordpress_url: http://dltj.org/2006/09/standards-compliant-web-video/
date: '2006-09-25 20:59:14 -0400'
date_gmt: '2006-09-26 00:59:14 -0400'
categories:
- Raw Technology
tags:
- video
- section508
- accessibility
- web standards
comments:
- id: 4803
  author: 'AccessBlog - Nachrichten '
  author_email: ''
  author_url: http://www.einfach-fuer-alle.de/blog/index.php?id=P1867
  date: '2006-09-27 11:01:03 -0400'
  date_gmt: '2006-09-27 15:01:03 -0400'
  content: "<!--%kramer-ref-pre%-->[...] Peter Murray: &raquo;Embedded Web Video in
    a Standards-Compliant, Accessible, and Successful Way&laquo; [...]<!--%kramer-ref-post%-->"
- id: 5164
  author: Login | mister-wong.de | Social Bookmarking Tool
  author_email: ''
  author_url: http://www.mister-wong.de/index.php?action=addurl&amp;bm_url=http3A2F2Fdltj.org2F20062F092Fstandards-compliant-web-video2F&amp;bm_description=Embedded20Web20Video20in20a20Standards-Compliant2C20Access
  date: '2006-10-01 10:24:27 -0400'
  date_gmt: '2006-10-01 14:24:27 -0400'
  content: "<!--%kramer-ref-pre%-->[...] Bookmark hinzuf&uuml;gen Du m&ouml;chtest
    folgenden Link zu Mister Wong hinzuf&uuml;gen: Embedded Web Video in a Standards-Compliant,
    Accessible, and Successful Way in Disruptive Library Technology Jester (http://dltj.org/2006/09/standards-compliant-web-video/)
    - Falls du noch nicht angemeldet bist, kannst du dich hier kostenlos registrieren
    - Hier kannst du dich einloggen.   Was kann, hat und macht Mister Wong? &raquo;
    [...]<!--%kramer-ref-post%-->"
- id: 5190
  author: 'TangognaT &raquo; Carnival of the Infosciences #56'
  author_email: ''
  author_url: http://www.tangognat.com/2006/10/01/carnival-of-the-infosciences-56-2/
  date: '2006-10-01 23:10:33 -0400'
  date_gmt: '2006-10-02 03:10:33 -0400'
  content: "[...] You get all the details you would ever want about embedding video
    in a web page in a standards-compliant way at Disruptive Library Technology Jester.
    Perl code is included, and I don&#8217;t know how much more fun it gets than that.
    [...]"
- id: 6026
  author: 'Walt at Random &raquo; Blog Archive &raquo; Printability: It&#8217;s not
    just for Firefox anymore'
  author_email: ''
  author_url: http://walt.lishost.org/?p=397
  date: '2006-10-24 22:30:31 -0400'
  date_gmt: '2006-10-25 02:30:31 -0400'
  content: "<!--%kramer-ref-pre%-->[...] I tried your site and was pleased to find
    a nice print media CSS declaration. (Or, in the case of WaR, I think what is happening
    when the page is printed is the absence of a CSS declaration because you are using
    media=&#8221;screen&#8221; attribute.) How your page appears when printed (and
    given your typography interest, this comes as no surprise to you) is very important.
    I worked for a number of hours to make sure it came out right on DLTJ as well.
    Try printing a random posting on DLTJ and you&#8217;ll see what I mean. [...]<!--%kramer-ref-post%-->"
- id: 12516
  author: 'Disruptive Library Technology Jester :: Update to &#8220;Embedded Web Video
    in a Standards-Compliant, Accessible, and Successful Way&#8221;'
  author_email: ''
  author_url: http://dltj.org/2007/02/update-to-embedded-web-video/
  date: '2007-02-21 15:41:32 -0500'
  date_gmt: '2007-02-21 20:41:32 -0500'
  content: "[...] Last year I published an entry called Embedded Web Video in a Standards-Compliant,
    Accessible, and Successful Way on how to embed (without using the non-standard
    <EMBED> tag) video on an HTML page. It has been one of the most widely read articles
    on DLTJ.org, and so I wanted to publish an updated version of the script from
    that article to take into account this new wrinkle from Microsoft. The change
    is at line #41 below: Code (perl)#!/usr/bin/perl -w [...]"
- id: 12754
  author: 'Disruptive Library Technology Jester :: Resource for Improving Higher Education
    Instruction'
  author_email: ''
  author_url: http://dltj.org/2007/03/fame/
  date: '2007-03-03 17:14:33 -0500'
  date_gmt: '2007-03-03 22:14:33 -0500'
  content: "[...] A few months back I referred to a project that used video to present
    information about accessibility needs in the classroom. That article was about
    how difficult it is to create markup for embedded video that is universally accessible
    and valid HTML. Late last month the larger project that used that work was released.
    Called the Faculty &#38; Administrator Modules in Higher Education, or FAME, it
    is a professional development tool for use in higher education with information
    on how college faculty, administrators, disability service providers, and students
    can work individually and collaboratively to improve the accommodations, teaching-learning
    process, and overall campus environment for students with disabilities. The content
    on the website is broken up into five modules: [...]"
- id: 20091
  author: Jacobs Media - jacoBLOG
  author_email: ''
  author_url: http://jacobsmedia.typepad.com/jacobs/2007/08/theater-of-the-.html
  date: '2007-08-07 00:00:00 -0400'
  date_gmt: '2007-08-07 04:00:00 -0400'
  content: "<!--%kramer-pre%--> This translates to 132 million Americans watching
    streaming video, with YouTube leading the way.  And of those consumers, they average
    two videos a day.  So what does this tell us about our content and our business?
    \ Video needs to be a component of everything we do.  It needs to be integrated
    into our personality shows, whether it's via webcams or listener-submitted videos.
    \ Events need to be covered with video to capture the excitement of station events,
    contests, interviews, etc.<!--%kramer-post%-->"
- id: 33776
  author: Embedding audio and video
  author_email: ''
  author_url: ''
  date: '2008-08-23 12:17:26 -0400'
  date_gmt: '2008-08-23 16:17:26 -0400'
  content: "<!--%kramer-ref-pre%-->[...]  http://dltj.org/article/standards-compliant-web-video/
    Embedded Web Video in a Standards-Compliant, Accessible, and Successful Way [...]<!--%kramer-ref-post%-->"
---
<p>The word "Successful" in the title, when juxtaposed with "Standards-Compliant" and "Accessible," should be big, bold and flashing (except that the flashing style would then go against web accessibility best practice).  The goal is to embed a video clip into a web page that validates as "XHTML4.01 Transitional", includes a Closed Captioning text track to be displayed in the web page, and could be viewed in one of three flavors:  Windows Media, QuickTime, and Real.  And the content being presented is about using accessible technologies in the classroom, so it had to be "right."  This task was much harder than I thought, and I'll offer much harder than it should have been.  Piecing together sources too numerous to mention, I managed to make it happen ... with just a few caveats.  Here, documented for all time, or at least until dltj.org goes away or the next major browser/streaming-client revision (which ever comes first) is how it can be done.</p>
<h2>The Content</h2>
<p>I hope someday soon to actually post a link to this content online where you can see at least the public face of this solution at play.  The content is for a series of web-based modules for faculty and administrators to help improve the quality of education for students with disabilities.  It is top-notch stuff, and it has been a real honor to work with the team that put it together.  For my piece of it, though, they gave me a set of directories, broken out by media type, with this content:</p>
<dl>
<dt>Windows/</dt>
<dd>.wmv (the video) and .smi (the closed caption text track)</dd>
<dt>Real/</dt>
<dd>.rm (the video), .rt (the closed caption text track) and .smi (the container that pulls the first two together)</dd>
<dt>Quicktime/</dt>
<dd>.mov (the video)</dd>
</dl>
<p>Now right out of the gate we're fudging things a little bit.  For whatever reason the team developing the content decided to punt when it came to the text track in Quicktime.  I don't know if there was an insurmountable barrier or some other reason, but the practical upshot is that the Quicktime version of the video includes the text track an "open caption" encoded right into the video stream.  That makes Quicktime, from my perspective, very easy to deal with.</p>
<p>Those with a keen eye will notice that both the Windows Media and the Real Media version have  a .smi file.  This is true, but they are not identical.  Windows media wants to use a .asx file as its container object and only uses the .smi for the text stream.  The Real Media version has the text stream in .rt files.  Could these be combined?  Perhaps, but I've got real-world problems to solve and this is what I was given.  In any case, I don't think it makes the end result any easier or harder than it would be otherwise.</p>
<h2>Serving Up the Content</h2>
<p>We use a Helix Streaming Media server from Real Networks, Inc., as our content server, but that isn't the really interesting part of this quest.  Another requirement, was that the URLs to these various media files needed to be persistent, <em>is</em> an interesting problem.  The HTML that will include the URLs could be copied and distributed to hundreds if not thousands of sites eventually, so updating the URLs in web pages because a machine name changed or we decide to use a Darwin Streaming Server rather than a Helix Streaming Server for Quicktime would be impossible to get done right.  OhioLINK (my employer), being a content provider for member libraries, created a persistent URL service years ago for its content called "RAVE" (or <b><u>R</u></b>andom <b><u>A</u></b>ccess to <b><u>V</u></b>irtually <b><u>E</u></b>verything), so it made sense to have the URLs to the media pieces be "RAVE URLs".  RAVE URLs are handled by PERL scripts running on an Apache virtual host called "rave.ohiolink.edu".  These PERL scripts read the parameters of the request and issue an HTTP 302 ("Moved Temporarily") redirect to the real location of the content.  In doing so, we only need to change the address of the content in one place -- the RAVE script -- when the location moves (rather than in the hundreds of web pages or bookmarks or what-have-you).</p>
<p>For the purposes of this project, these RAVE URLs were defined as this (the http protocol prefix is omitted so over-anxious RSS readers will not attempt to turn them into hyperlinks; "blah" is a placeholder for the project name; and [id] represents the identifier for the video segment):</p>
<dl style="margin-left: 3em">
<dt>rave.ohiolink.edu/dmc/blah/quicktime/[id]</dt>
<dd>Redirects to the location of the Quicktime file (a hinted .mov file, so it starts playing in the browser right away)</dd>
<dt>rave.ohiolink.edu/dmc/blah/real/[id]</dt>
<dd>Redirects to the location of the .smi container file via the mms protocol through the Helix streaming server</dd>
<dt>rave.ohiolink.edu/dmc/blah/windows/wmv/[id]</dt>
<dd>Redirects to the location of the wmv video file via the mms protocol through the Helix streaming server</dd>
<dt>rave.ohiolink.edu/dmc/blah/windows/smi/[id]</dt>
<dd>Pulls the .smi file off of the streaming server and sends it back to the browser with the appropriate MIME type</dd>
<dt>rave.ohiolink.edu/dmc/blah/windows/asx/[id]</dt>
<dd>Dynamically creates a .asx container that pulls together the <code>windows/smi</code> and the <code>windows/wmv</code> files</dd>
</dl>
<p>Here are the first of the tricky bits.  First, it seems like Windows Media Player can't cope with a 302 redirect message in response to its request for a .smi file.  "Can't cope" can be restated as "ignores"; it doesn't throw an error, it just plays the file as if there was no closed captioning text.  To get around this, the RAVE script has a bit of PERL where it asks like a web client to pull the .smi file off of the video server and send it back out to the media player.</p>
<div style="padding 1em; border: 1px solid red; margin: 1em; background: yellow; color: black;">
Note &mdash; the Perl script included below was updated in February 2007 to include <a href="/article/update-to-embedded-web-video/">a fix for the deprecation of the MMS protocol</a> in Windows Media Player.</div>
<p>Second -- again for those with eagle eyes -- is the dynamic generation of an .asx file.  As it turns out, one can relate a .smi text-track file with a .wmv video file by including it as a SAMI parameter on the URL.  By far the best practice for doing this seems to be to relate the .smi and the .wmv files in a .asx container file.  So we create one on-the-fly.  The PERL code looks like this:</p>
{% highlight perl %}
#!/usr/bin/perl -w
# Copyright (C) 2006 OhioLINK
#
# This file is part of the OhioLINK Digital Resource Commons (DRC) Project.
#
# The OhioLINK DRC is free software; you can redistribute it and/or
# modify it under the terms of the Affero General Public License as
# published by Affero, Inc. -- either version 1 of the License, or
# (at your option) any later version.
#
# The OhioLINK DRC Project is distributed in the hope that it will be
# useful, but WITHOUT ANY WARRANTY -- without even the implied warranty
# of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# Affero General Public License for more details.
#
# You should have received a copy of the Affero General Public
# License in the LICENSE.txt file that comes with the DRC project;
# if not, write to DRC Development Team, OhioLINK, 2455 North Star Rd, 
# Suite 300, Columbus, OH 43221, USA.

if (!$ENV{PATH_INFO}) {
  print "Location: http://no-path-info-given/\r\n\r\n";
} else {
  ($format,$id) = $ENV{PATH_INFO} =~ q#^/+(.*?)/(.*)$#;

  if ($format =~ /Quicktime/i) {
    print "Location: http://video.ohiolink.edu/blah/Quicktime/$id\r\n\r\n";
  } elsif ($format =~ /Real/i) {
    print "Location: http://video.ohiolink.edu:8080/ramgen/blah/Real/$id\r\n\r\n"; 
  } elsif ($format =~ /Windows/i) {
    ($winType,$winFile) = $id =~ q#^(.*?)/(.*)$#;
    if ($winType =~ /asx/i) {
      $winFile =~ s/\..*$//;
      print >> "EoMarkup";
Content-type: video/x-ms-asf

<asx version="3.0">
<copyright>(c) 2005 - xxx</copyright>
<entry>
<ref href="mms://video.ohiolink.edu/blah/Windows/$winFile.wmv?SAMI=http://rave.ohiolink.edu/dmc/blah/windows/smi/$winFile.smi">
<copyright>(c) 2005 - xxx</copyright>
</ref></entry>
</asx> 
EoMarkup
    } elsif ($winType =~ /wmv/i) {
      print "Location: mms://video.ohiolink.edu/blah/Windows/$winFile\r\n\r\n";
    } elsif ($winType =~ /smi/i) {
      use LWP::UserAgent;
      $ua = LWP::UserAgent->new;
      $ua->agent("$0-lwp/0.1 " . $ua->agent);
      $req = HTTP::Request->new(GET => "http://video.ohiolink.edu:8080/blah/Windows/$winFile");
      # send request
      $res = $ua->request($req);
      # check the outcome
      if ($res->is_success) {
        print "Content-type: application/smil\r\n\r\n";
        print $res->decoded_content;
      } else {
        print "Location: http://error-from-remote-server/$winType/$winFile/".$res->code."/".$res->message."\r\n\r\n";
      }
    } else {
      print "Location: http://invalid-Windows-format-given/$winType/$winFile\r\n\r\n";
    }
  } else {
    print "Location: http://invalid-format-given/$format/$id\r\n\r\n";
  }
}
{% endhighlight %}
<p>The first part of the script parses the PATH_INFO variable -- everything left over from the <i>blah</i> script name -- and if what is requested is the Real Media or the Quicktime version of the video it sends the redirect back to the client (in the form of the "Location:" header with Apache HTTP daemon handling the 302 response code).  If what is requested is the Windows variety, it further parses the PATH_INFO piece for the file type and acts according to that:  for wmv, it redirects; for asx, it generates the .asx file; and for .smi, it pulls the content off the video server and returns it to the client.</p>
<h2>The Markup</h2>
<p>So now that we can serve up the video content with persistent URLs, we need to tackle the HTML markup.  As a general rule, we can't use the <a href="http://www.webstandards.org/learn/articles/askw3c/may2005/" title="Adding Multimedia in Web Documents (part 2) - The Web Standards Project">popular yet non-standard <code><embed></code> tag</a>; since it is not part of any formal specification, validation will always fail.  As a consequence, use in future browsers is less assured.  So we need to use <code><object></code> -- and unfortunately due to varied, if not outright broken implementations of the <code><object></code> tag, we need to be a little tricky in how we code it.  Other tricks are in play here as well -- check the list of "Resources Consulted" below for more information.</p>
<p>Also note that many of the recommendations out there start off with something like "if you have media to show, <em>don't</em> embed it into your web page; but if you must, here is one way to do it."  The reason for this is pretty simple, if not obvious after a little thought:  folks using alternate browsing/computing techniques (e.g. keyboard only for limited mobility, auditory only for sight impaired, visual only for the hearing impaired, etc.) lose much of their ability to control the flow of information because it is tied up in the functionally-limited browser rather than the native media player.  These same recommendations go on to say that if you do embed the media into the web page, provide a link for the user to access it using the native media player.</p>
<p>So based on the URLs to the media objects described above, this is what the HTML markup looks like:</p>
<h3>Quicktime</h3>
<p><br clear="all" /></p>
{% highlight html %}
<object classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B" codebase="http://www.apple.com/qtactivex/qtplugin.cab" width="320" height="380">
  <param name="src" value="http://rave.ohiolink.edu/dmc/blah/quicktime/[id].mov" />
  <param name="controller" value="true" />
  <param name="autoplay" value="true" />
  <!--[if !IE]>-->
    </object><object type="video/quicktime" data="http://rave.ohiolink.edu/dmc/blah/quicktime/[id].mov" width="320" height="380">
     <param name="autoplay" value="true" />
     <param name="controller" value="true" />
    </object>
   <!--<![endif]-->

<br />
<span class="removed_link" title="http://rave.ohiolink.edu/dmc/blah/quicktime/[id].mov">View Video with External Player</span>
{% endhighlight %}

<h3>Windows Media</h3>
<p><br clear="all" /></p>
{% highlight html %}
<object classid="clsid:6bf52a52-394a-11d3-b153-00c04f79faa6" type="application/x-oleobject" width="320" height="304" id="Player1">
  <param name="url" value="http://rave.ohiolink.edu/dmc/blah/windows/asx/[id].asx" />
  <param name="src" value="http://rave.ohiolink.edu/dmc/blah/windows/asx/[id].asx" />
  <param name="autostart" value="true" />
  <param name="showcontrols" value="true" />
  <param name="uimode" value="mini" />
  <param name="captioningID" value="CapText" />
  <param name="SAMIFileName" value="http://rave.ohiolink.edu/dmc/blah/windows/smi/scott.smi" />
    <!--[if !IE]>-->
     </object><object type="video/x-ms-wmv" data="http://rave.ohiolink.edu/dmc/blah/windows/asx/[id].asx" width="320" height="304" id="Player2">
     <param name="src" value="http://rave.ohiolink.edu/dmc/blah/windows/asx/[id].asx" />
     <param name="autostart" value="true" />
     <param name="showcontrols" value="true" />
     <param name="uimode" value="mini" />
     <param name="captioningID" value="CapText" />
     <param name="SAMIFileName" value="http://rave.ohiolink.edu/dmc/blah/Windows/smi/[id].smi" />
    </object>
   <!--!<[endif]-->

<br />
<span class="removed_link" title="http://rave.ohiolink.edu/dmc/blah/windows/asx/[id].asx">View Video with External Player (including captions)</span>
{% endhighlight %}

<h3>Real Media</h3>
<p>One last caveat.  As if the shenanigans above weren't bad enough, apparently as part of a court settlement against Microsoft a number of years ago, there was an injunction placed against the creator of Internet Explorer that prevented that browser from automatically launching content embedded in a web page.  For whatever reason (I didn't have time to investigate <em>why</em> this happened), it only impacts Real Media content.  Somehow, though, it is okay for the browser to start it if the action is called from an external piece of JavaScript.  Go figure.  You can read more about it at Real Media's support site for <a href="http://www.realnetworks.com/resources/howto/embedded/iechanges/index.html" title="">Web Page Embedding > Internet Explorer Changes</a>.  In actuality, though, it makes the Real Media part of the equation pretty easy:</p>
{% highlight html %}
<script language="JavaScript" type="text/javascript">
  AC_RunRealContent( 
    "id", "player",  
    "width", "320",  
    "height", "280",  
    "CONTROLS", "imagewindow",  
    "CONSOLE", "radio",  
    "AUTOSTART", "TRUE",  
    "type", "audio/x-pn-realaudio-plugin",  
    "SRC", "http://rave.ohiolink.edu/dmc/blah/real/[id].smi"
  );
  window.document.write('<br />');
  AC_RunRealContent( 
    "id", "controls",  
    "width", "320",  
    "height", "36",  
    "CONTROLS", "ControlPanel",  
    "CONSOLE", "radio", 
    "type", "audio/x-pn-realaudio-plugin",  
    "SRC", "http://rave.ohiolink.edu/dmc/blah/real/[id].smi"
  );
</script>
<br />
<span class="removed_link" title="http://rave.ohiolink.edu/dmc/fame/Real/scott.smi">View Video with External Player (including captions)</span>
{% endhighlight %}

<h2>Conclusion</h2>
<ol>
<li>It seems to work for me and the machines I test with; your mileage may vary.</li>
<li>If you know of a better way to do it, please let me know!</li>
</ol>
<h2>Resources Consulted</h2>
<p>Here is a short list of the most helpful resources used to accomplish this feat:</p>
<ul>
<li>"<a href="http://alistapart.com/articles/byebyeembed" title="A List Apart: Articles: Bye Bye Embed">Bye Bye Embed</a>" by Elizabeth Castro on A List Apart</li>
<li>"<a href="http://www.webaim.org/techniques/captions/" title="WebAIM: Web Captioning Overview">Web Captioning</a>" in the Web Accessibility In Mind project</li>
</ul>
<p style="padding:0;margin:0;font-style:italic;" class="removed_link">The text was modified to remove a link to http://rave.ohiolink.edu/dmc/fame/Real/scott.smi on August 22nd, 2013.</p>
